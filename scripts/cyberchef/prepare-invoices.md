[
  { "op": "Comment",
    "args": ["C00 High level: clean lines, build HUB rows, compute totals, and output summary sections."] },
  { "op": "Comment",
    "args": ["C01 Trim leading and trailing whitespace from each line."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "^[ \\t]+|[ \\t]+$" }, "", true, false, true, false] },
  { "op": "Comment",
    "args": ["C02 Remove any text before the first 10 digit number on a line."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "^.*?(?=\\d{10}|$)" }, "", true, false, true, false] },
  { "op": "Comment",
    "args": ["C03 Collapse multiple blank lines down to a single newline."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "[\\r\\n]{2,}" }, "\\n", true, false, true, false] },
  { "op": "Comment",
    "args": ["C04 Normalise spaces and tabs so there is a single tab between columns."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "\\t+|(?:\\s+\\t+|\\t+\\s+)+" }, "\\t", true, false, true, false] },
  { "op": "Comment",
    "args": ["C05 Remove currency symbols and commas from numeric amounts."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "\\$ *|," }, "", true, false, true, false] },
  { "op": "Comment",
    "args": ["C06 Reshape each row into HUB prefix form with last one or two numeric amounts grouped."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "(\\d+?)\\s+(\\S+?)\\s+(\\d+?)\\s+(\\d+(?:\\.\\d*)?(?:\\s+\\d+(?:\\.\\d*)?)?)$" }, "HUB-$1-$2-$3\\t|\\t$4", true, false, true, false] },
  { "op": "Comment",
    "args": ["C07 Ensure remaining multiple spaces or tabs between fields become a single tab."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "[ \\t]+" }, "\\t", true, false, true, false] },
  { "op": "Comment",
    "args": ["C08 Subsection on the numeric part after the pipe so we can safely sum per row amounts."] },
  { "op": "Subsection",
    "args": ["(?<=\\|[ \\t])(\\d+(?:\\.\\d*)?(?:[ \\t]\\d+(?:\\.\\d*)?)?)", true, true, false] },
  { "op": "Comment",
    "args": ["C09 Inside subsection collapse any internal whitespace in the numeric part to single spaces."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "[ \\t]+" }, " ", true, false, true, false] },
  { "op": "Comment",
    "args": ["C10 Sum the space separated numeric values inside each subsection to get a row total."] },
  { "op": "Sum",
    "args": ["Space"] },
  { "op": "Comment",
    "args": ["C11 Merge the subsection back into full lines with the new row totals in place."] },
  { "op": "Merge",
    "args": [true] },
  { "op": "Comment",
    "args": ["C12 Remove any trailing whitespace or newlines at the very end of the output."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "[\\n\\s]+$" }, "", true, false, true, false] },
  { "op": "Comment",
    "args": ["C13 Add line numbers to the full HUB view and store it in register R0 as the master copy."] },
  { "op": "Add line numbers",
    "args": [] },
  { "op": "Register",
    "args": ["([\\s\\S]*)", true, true, false] },
  { "op": "Comment",
    "args": ["C14 From the HUB view extract each amount after the pipe on every row."] },
  { "op": "Regular expression",
    "args": ["User defined", "(?<=\\|\\s)([\\d,]+(?:\\.\\d+)?)\\s*$", true, true, false, false, false, false, "List capture groups"] },
  { "op": "Comment",
    "args": ["C15 Add line numbers to the list of row amounts and save that list into register R1."] },
  { "op": "Add line numbers",
    "args": [] },
  { "op": "Register",
    "args": ["([\\s\\S]*)", true, false, false] },
  { "op": "Comment",
    "args": ["C16 Restore master HUB lines from R0 so we can extract other fields."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "([\\s\\S]*)" }, "$R0", false, false, true, false] },
  { "op": "Comment",
    "args": ["C17 Extract the first field after HUB dash which is the first id column used as stock numbers."] },
  { "op": "Regular expression",
    "args": ["User defined", "(?<=HUB-)(.+?)(?=-)", true, true, false, false, false, false, "List capture groups"] },
  { "op": "Comment",
    "args": ["C18 Add line numbers to this first id column and store it in register R2."] },
  { "op": "Add line numbers",
    "args": [] },
  { "op": "Register",
    "args": ["([\\s\\S]*)", true, false, false] },
  { "op": "Comment",
    "args": ["C19 Pad lines so each stock line has three fields and save as R3 for invoice numbers section."] },
  { "op": "Pad lines",
    "args": ["End", 3, "-TR"] },
  { "op": "Register",
    "args": ["([\\s\\S]*)", true, false, false] },
  { "op": "Comment",
    "args": ["C20 Restore the master HUB view from R0 again before extracting VIN values."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": ".*" }, "$R0", false, true, true, true] },
  { "op": "Comment",
    "args": ["C21 Extract the second HUB field which is treated as the VIN value."] },
  { "op": "Regular expression",
    "args": ["User defined", "(?:HUB-.+?-)(.+?)(?=-)", true, true, false, false, false, false, "List capture groups"] },
  { "op": "Comment",
    "args": ["C22 Add line numbers to the VIN list and store it in register R4."] },
  { "op": "Add line numbers",
    "args": [] },
  { "op": "Register",
    "args": ["([\\s\\S]*)", true, false, false] },
  { "op": "Comment",
    "args": ["C23 Restore the master HUB view from R0 again before extracting PID values."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "([\\s\\S]*)" }, "$R0", false, true, true, false] },
  { "op": "Comment",
    "args": ["C24 Extract the third HUB field which is treated as the PID value."] },
  { "op": "Regular expression",
    "args": ["User defined", "(?:HUB-.+?-.+?-)(.+?)(?=\\s)", true, true, false, false, false, false, "List capture groups"] },
  { "op": "Comment",
    "args": ["C25 Add line numbers to the PID list and save it into register R5."] },
  { "op": "Add line numbers",
    "args": [] },
  { "op": "Register",
    "args": ["([\\s\\S]*)", true, false, false] },
  { "op": "Comment",
    "args": ["C26 Restore the master HUB view from R0 again so totals can be processed."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "([\\s\\S]*)" }, "$R0", false, false, true, false] },
  { "op": "Comment",
    "args": ["C27 Build a list of all row totals by matching the amount after the pipe on each line."] },
  { "op": "Regular expression",
    "args": ["User defined", "(?<=\\|[\\t ])([\\d,]+(?:\\.?\\d+)?) *$", true, true, false, true, false, true, "List matches"] },
  { "op": "Comment",
    "args": ["C28 From the Total found line capture the count of totals and store it in register R6."] },
  { "op": "Register",
    "args": ["(?<=[Tt]otal found: )(([\\d,]+(?:\\.?\\d+)?))", true, false, false] },
  { "op": "Comment",
    "args": ["C29 Remove the Total found header block so we are left with only one amount per line."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "[Tt]otal found:[\\s\\S]+?\\n{2,}" }, "", true, false, true, false] },
  { "op": "Comment",
    "args": ["C30 Sum all line separated amounts to get the grand total for all rows."] },
  { "op": "Sum",
    "args": ["Line feed"] },
  { "op": "Comment",
    "args": ["C31 Prepend the original HUB lines from R0 and a GRAND TOTAL label before the summed value."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "^" }, "$R0\\n\\n\\tGRAND TOTAL\\t", true, false, true, false] },
  { "op": "Comment",
    "args": ["C32 Store this combined view with HUB lines and grand total into register R7 as a snapshot."] },
  { "op": "Register",
    "args": ["([\\s\\S]*)", true, false, false] },
  { "op": "Comment",
    "args": ["C33 From the combined view extract HUB descriptors which will act as descriptions."] },
  { "op": "Regular expression",
    "args": ["User defined", "(HUB-.+?-.+?-.+?(?=\\s))", true, true, false, false, false, false, "List matches"] },
  { "op": "Comment",
    "args": ["C34 Add line numbers to the HUB descriptions and save as register R8."] },
  { "op": "Add line numbers",
    "args": [] },
  { "op": "Register",
    "args": ["([\\s\\S]*)", true, false, false] },
  { "op": "Comment",
    "args": ["C35 Replace current output with the line numbered HUB descriptions from register R8."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "([\\s\\S]*)" }, "$R8", false, false, true, false] },
  { "op": "Comment",
    "args": ["C36 Append a Total Count line using the count stored earlier in register R6."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "$" }, "\\n\\tTotal Count:\\t$R6", false, false, false, false] },
  { "op": "Comment",
    "args": ["C37 Append all summary sections using the captured registers for each data type."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "$" }, "\\n\\nPaid Amounts:\\n$R1\\n\\nDescriptions:\\n$R9\\n\\nStock Numbers:\\n$R2\\n\\nVIN Numbers:\\n$R4\\n\\nPID Numbers:\\n$R5\\n\\nInvoice Numbers:\\n$R3", false, false, false, false] },
  { "op": "Comment",
    "args": ["C38 Capture final combined output into register R9 for later reuse if needed."] },
  { "op": "Register",
    "args": ["([\\s\\S]*)", true, false, false] },
  { "op": "Comment",
    "args": ["C39 Optional disabled step to strip line numbers from the start of each line if enabled."] },
  { "op": "Find / Replace",
    "args": [{ "option": "Regex", "string": "^\\s*\\d+\\s*" }, "", true, false, true, false],
    "disabled": true }
]